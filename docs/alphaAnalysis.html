<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="caitlinpage" />

<meta name="date" content="2025-09-08" />

<title>alphaAnalysis</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">3_cf_nano</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/caitlinpage/methyl_nano_cf">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">alphaAnalysis</h1>
<h4 class="author">caitlinpage</h4>
<h4 class="date">2025-09-08</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-09-24
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>methyl_nano_cf/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20250606code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20250606)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20250606code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20250606)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomcaitlinpagemethylnanocftree38b94f731735691f3c21b4218b973cdc07863627targetblank38b94f7a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/caitlinpage/methyl_nano_cf/tree/38b94f731735691f3c21b4218b973cdc07863627" target="_blank">38b94f7</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomcaitlinpagemethylnanocftree38b94f731735691f3c21b4218b973cdc07863627targetblank38b94f7a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/caitlinpage/methyl_nano_cf/tree/38b94f731735691f3c21b4218b973cdc07863627" target="_blank">38b94f7</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/figure/
    Ignored:    renv.lock
    Ignored:    renv/

Untracked files:
    Untracked:  analysis/filteringReads.Rmd

Unstaged changes:
    Modified:   .Rprofile
    Modified:   .gitignore
    Modified:   analysis/binningGenome.Rmd
    Modified:   analysis/checkAlphaAndBetaMatch.Rmd
    Modified:   analysis/index.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/alphaAnalysis.Rmd</code>) and
HTML (<code>docs/alphaAnalysis.html</code>) files. If you’ve configured
a remote Git repository (see <code>?wflow_git_remote</code>), click on
the hyperlinks in the table below to view the files as they were in that
past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/caitlinpage/methyl_nano_cf/blob/38b94f731735691f3c21b4218b973cdc07863627/analysis/alphaAnalysis.Rmd" target="_blank">38b94f7</a>
</td>
<td>
caitlinpage
</td>
<td>
2025-09-24
</td>
<td>
wflow_publish("analysis/alphaAnalysis.Rmd")
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/caitlinpage/methyl_nano_cf/blob/f3a8a1428ccf67eb41d981e9908b594a749954e7/analysis/alphaAnalysis.Rmd" target="_blank">f3a8a14</a>
</td>
<td>
caitlinpage
</td>
<td>
2025-09-08
</td>
<td>
commit - making average alpha per position
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/caitlinpage/methyl_nano_cf/blob/4b951b9d78de4ee2571f106d781e8c54bb61952c/analysis/alphaAnalysis.Rmd" target="_blank">4b951b9</a>
</td>
<td>
caitlinpage
</td>
<td>
2025-09-08
</td>
<td>
init commit
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<pre class="r"><code>library(plyranges)</code></pre>
<pre><code>Loading required package: BiocGenerics</code></pre>
<pre><code>
Attaching package: &#39;BiocGenerics&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:stats&#39;:

    IQR, mad, sd, var, xtabs</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff,
    table, tapply, union, unique, unsplit, which.max, which.min</code></pre>
<pre><code>Loading required package: IRanges</code></pre>
<pre><code>Loading required package: S4Vectors</code></pre>
<pre><code>Loading required package: stats4</code></pre>
<pre><code>
Attaching package: &#39;S4Vectors&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:utils&#39;:

    findMatches</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    expand.grid, I, unname</code></pre>
<pre><code>Loading required package: GenomicRanges</code></pre>
<pre><code>Loading required package: GenomeInfoDb</code></pre>
<pre><code>Warning: replacing previous import &#39;S4Arrays::makeNindexFromArrayViewport&#39; by
&#39;DelayedArray::makeNindexFromArrayViewport&#39; when loading &#39;SummarizedExperiment&#39;</code></pre>
<pre><code>
Attaching package: &#39;plyranges&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:IRanges&#39;:

    slice</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    filter</code></pre>
<pre class="r"><code>library(tidyr)</code></pre>
<pre><code>
Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:S4Vectors&#39;:

    expand</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>
Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:plyranges&#39;:

    between, n, n_distinct</code></pre>
<pre><code>The following objects are masked from &#39;package:GenomicRanges&#39;:

    intersect, setdiff, union</code></pre>
<pre><code>The following object is masked from &#39;package:GenomeInfoDb&#39;:

    intersect</code></pre>
<pre><code>The following objects are masked from &#39;package:IRanges&#39;:

    collapse, desc, intersect, setdiff, slice, union</code></pre>
<pre><code>The following objects are masked from &#39;package:S4Vectors&#39;:

    first, intersect, rename, setdiff, setequal, union</code></pre>
<pre><code>The following objects are masked from &#39;package:BiocGenerics&#39;:

    combine, intersect, setdiff, union</code></pre>
<pre><code>The following objects are masked from &#39;package:stats&#39;:

    filter, lag</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(ggplot2)</code></pre>
<pre class="r"><code>all_samples &lt;- readRDS(&quot;/researchers/caitlin.page/cf_nano/r_output/all_samples.rds&quot;)
overlap_bins_reads &lt;- readRDS(&quot;/researchers/caitlin.page/cf_nano/r_output/overlap_bins_reads.rds&quot;)
cg_sites &lt;- readRDS(&quot;/researchers/caitlin.page/cf_nano/r_output/cg_sites.rds&quot;)</code></pre>
<pre class="r"><code>head(all_samples)</code></pre>
<pre><code>                               read_id seqnames    start      end read_length
1 7f095597-d2c5-47a2-93aa-d84b7f9abc94    chr22 10521100 10521455         355
2 e9abf215-8192-48f4-a50f-ef92241e5de3    chr22 10522473 10522658         185
3 4203dd9d-9bff-4d14-b046-7716315e9699    chr22 10524645 10524786         141
4 baf45276-b37b-43fd-8a33-6727de6255fa    chr22 10527072 10527210         138
5 a75ce5a8-42f2-4fe2-b62b-35aba109507d    chr22 10529269 10529453         184
6 b5e822b7-e149-4ae2-8937-fe4d570a274e    chr22 10534032 10534204         172
     type sample index_cg      meth_pattern
1 healthy hu5.10       48                 T
2 healthy hu5.10       53              CCTT
3 healthy hu5.10       68                 T
4 healthy hu5.10      299 CCCCCCCCCCCCCCCCC
5 healthy hu5.10      374                TT
6 healthy hu5.10      408                TT
                                                        cpg_positions
1                                                                  48
2                                                         53,54,55,56
3                                                                  68
4 299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315
5                                                             374,375
6                                                             408,409
                                                                                                                                           genom_positions
1                                                                                                                                                 10521180
2                                                                                                                      10522481,10522501,10522591,10522649
3                                                                                                                                                 10524771
4 10527071,10527087,10527090,10527093,10527108,10527114,10527116,10527119,10527130,10527136,10527138,10527153,10527156,10527172,10527189,10527191,10527194
5                                                                                                                                        10529326,10529356
6                                                                                                                                        10534125,10534167
  num_meth total alpha read_start read_end
1        0     1   0.0   10521100 10521455
2        2     4   0.5   10522473 10522658
3        0     1   0.0   10524645 10524786
4       17    17   1.0   10527072 10527210
5        0     2   0.0   10529269 10529453
6        0     2   0.0   10534032 10534204</code></pre>
</div>
<div id="distribution-of-read-lengths" class="section level1">
<h1>distribution of read lengths</h1>
<pre class="r"><code>all_samples %&gt;% 
  ggplot(aes(x = log2(read_length), colour = type, group = sample)) +
  geom_density()</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_samples %&gt;%
  ggplot(aes(x = sample, y = log2(read_length), fill = type)) +
  geom_boxplot()</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-4-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_samples %&gt;%
  ggplot(aes(x = sample, y = log2(read_length), fill = type)) +
  geom_violin()</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-4-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="dsitribution-of-alpha-values" class="section level1">
<h1>dsitribution of alpha values</h1>
<pre class="r"><code>all_samples %&gt;% 
  ggplot(aes(x = alpha, colour = type, group = sample)) +
  geom_density()</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_samples %&gt;%
  ggplot(aes(x = sample, y = alpha, fill = type)) +
  geom_boxplot()</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_samples %&gt;%
  ggplot(aes(x = sample, y = alpha, fill = type)) +
  geom_violin()</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern) %&gt;% summarise(n=n(), length_pat = nchar(meth_pattern)) %&gt;% distinct() %&gt;% head()</code></pre>
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 3
# Groups:   meth_pattern [6]
  meth_pattern      n length_pat
  &lt;chr&gt;         &lt;int&gt;      &lt;int&gt;
1 C            134084          1
2 CC            87605          2
3 CCC           55411          3
4 CCCC          33896          4
5 CCCCC         21023          5
6 CCCCCC        12854          6</code></pre>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern) %&gt;% summarise(n=n(), length_pat = nchar(meth_pattern)) %&gt;% distinct() %&gt;% 
  ungroup() %&gt;% group_by(length_pat) %&gt;% summarise(n_length = n(), sum_length = sum(n)) %&gt;% head()</code></pre>
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 3
  length_pat n_length sum_length
       &lt;int&gt;    &lt;int&gt;      &lt;int&gt;
1          1        2     195617
2          2        4     157624
3          3        8     115395
4          4       16      81183
5          5       32      56598
6          6       64      39430</code></pre>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern) %&gt;% summarise(n=n(), length_pat = nchar(meth_pattern)) %&gt;% distinct() %&gt;% 
  ungroup() %&gt;% group_by(length_pat) %&gt;% summarise(n_length = n(), sum_length = sum(n)) %&gt;%
  ggplot(aes(x = length_pat, y = n_length)) +
  geom_point()</code></pre>
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;. You can override using the
`.groups` argument.</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern) %&gt;% summarise(n=n(), length_pat = nchar(meth_pattern)) %&gt;% distinct() %&gt;% 
  ungroup() %&gt;% group_by(length_pat) %&gt;% summarise(n_length = n(), sum_length = sum(n)) %&gt;%
  ggplot(aes(x = length_pat, y = sum_length)) +
  geom_point()</code></pre>
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;. You can override using the
`.groups` argument.</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;" />
* plot 1 is how many patterns have the same length? 2 patterns of length
1: either C or T etc (pattern length is same as number of cpgs in read)
* plot 2 is sum of the occurence of that pattern length</p>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern) %&gt;% summarise(n=n(), length_pat = nchar(meth_pattern)) %&gt;% distinct() %&gt;% 
  ungroup() %&gt;% group_by(length_pat) %&gt;% summarise(n_length = n(), sum_length = sum(n)) %&gt;%
  ggplot(aes(x = length_pat, y = n_length)) +
  geom_point() +
  scale_x_continuous(limits = c(0,100)) +
  labs(title = &quot;zoom in on plot 1&quot;)</code></pre>
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code>Warning: Removed 130 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>summary(all_samples$total)</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   3.000   4.083   5.000 612.000 </code></pre>
<pre class="r"><code>summary(unique(all_samples$total))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00   58.25  115.50  134.14  179.50  612.00 </code></pre>
<pre class="r"><code>summary(nchar(all_samples$meth_pattern))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   3.000   4.083   5.000 612.000 </code></pre>
<pre class="r"><code>summary(unique(nchar(all_samples$meth_pattern)))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00   58.25  115.50  134.14  179.50  612.00 </code></pre>
<ul>
<li>see total (num cpgs in read) as same as length of pattern</li>
</ul>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern, total, type) %&gt;% summarise(n=n()) %&gt;% group_by(type) %&gt;% mutate(prop_pattern_in_type = n/sum(n)) %&gt;% .[order(.$prop_pattern_in_type, decreasing = TRUE),] %&gt;% head()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;total&#39;. You can override
using the `.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 5
# Groups:   type [2]
  meth_pattern total type        n prop_pattern_in_type
  &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;   &lt;int&gt;                &lt;dbl&gt;
1 C                1 luad    89710               0.181 
2 C                1 healthy 44374               0.169 
3 CC               2 luad    57911               0.117 
4 CC               2 healthy 29694               0.113 
5 T                1 luad    42885               0.0865
6 CCC              3 luad    36432               0.0734</code></pre>
<ul>
<li><p>the highest proportion of patterns are basically the same for
healthy and luad</p></li>
<li><p>only use patterns with at least 3 cpgs</p></li>
</ul>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern, total, type) %&gt;% summarise(n=n()) %&gt;% filter(total &gt;= 3) %&gt;% group_by(type) %&gt;% mutate(prop_pattern_in_type = n/sum(n)) %&gt;% .[order(.$prop_pattern_in_type, decreasing = TRUE),] %&gt;% head()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;total&#39;. You can override
using the `.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 5
# Groups:   type [2]
  meth_pattern total type        n prop_pattern_in_type
  &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;   &lt;int&gt;                &lt;dbl&gt;
1 CCC              3 luad    36432               0.141 
2 CCC              3 healthy 18979               0.129 
3 CCCC             4 luad    22076               0.0855
4 CCCC             4 healthy 11820               0.0803
5 CCCCC            5 luad    13521               0.0524
6 CCCCC            5 healthy  7502               0.0510</code></pre>
<pre class="r"><code>all_samples %&gt;% filter(meth_pattern == &quot;CCC&quot;) %&gt;% head()</code></pre>
<pre><code>                               read_id seqnames    start      end read_length
1 79095d4b-2efa-41ea-bc20-065f94af5a64    chr22 10685761 10685916         155
2 22315981-4e7d-4773-afa4-74bc5f442af8    chr22 10726898 10727097         199
3 24f2ddfe-ba0e-4a98-b810-c6b8bb03267b    chr22 10757086 10757241         155
4 e3744c2b-ec90-4d70-97c2-b55785992b82    chr22 10761008 10761147         139
5 4cb56780-8d66-452a-8580-ba2cf4580a1b    chr22 10761026 10761179         153
6 8dcc8e94-87b7-4c18-9f68-0a1e94c716b2    chr22 10778755 10779078         323
     type sample index_cg meth_pattern  cpg_positions
1 healthy hu5.10     1687          CCC 1687,1688,1689
2 healthy hu5.10     2250          CCC 2250,2251,2252
3 healthy hu5.10     2674          CCC 2674,2675,2676
4 healthy hu5.10     2709          CCC 2709,2710,2711
5 healthy hu5.10     2709          CCC 2709,2710,2711
6 healthy hu5.10     2854          CCC 2854,2855,2856
             genom_positions num_meth total alpha read_start read_end
1 10685792,10685899,10685903        3     3     1   10685761 10685916
2 10726969,10727035,10727074        3     3     1   10726898 10727097
3 10757108,10757184,10757190        3     3     1   10757086 10757241
4 10761048,10761133,10761141        3     3     1   10761008 10761147
5 10761048,10761133,10761141        3     3     1   10761026 10761179
6 10778789,10778830,10778963        3     3     1   10778755 10779078</code></pre>
<pre class="r"><code>all_samples %&gt;% filter(total &gt;= 3, total &lt;= 10) %&gt;% distinct(meth_pattern, alpha) %&gt;% head()</code></pre>
<pre><code>  meth_pattern     alpha
1         CCTT 0.5000000
2          TTT 0.0000000
3          CTC 0.6666667
4        CCCCT 0.8000000
5         TTCT 0.2500000
6         CCCC 1.0000000</code></pre>
<ul>
<li>what am I trying to do?</li>
<li>was it like the entropy thing? because that would be in a region and
then looking at what patterns occur</li>
<li>I guess was also wondering what patterns occur the most - and if
there were any cancer specific</li>
</ul>
<pre class="r"><code>overlap_bins_reads %&gt;% filter(bin_num == 3780) %&gt;% group_by(meth_pattern, total) %&gt;% summarise(num_times = n()) %&gt;% ungroup() %&gt;% mutate(prop = num_times/sum(num_times)) %&gt;% .[order(.$prop, decreasing = TRUE),] %&gt;% head()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;. You can override using the
`.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 4
  meth_pattern total num_times   prop
  &lt;chr&gt;        &lt;int&gt;     &lt;int&gt;  &lt;dbl&gt;
1 C                1       328 0.339 
2 T                1       136 0.140 
3 CC               2        93 0.0961
4 TC               2        41 0.0424
5 CT               2        34 0.0351
6 TT               2        16 0.0165</code></pre>
<pre class="r"><code>overlap_bins_reads %&gt;% filter(bin_num == 3780) %&gt;% group_by(meth_pattern, total, alpha, type) %&gt;% summarise(num_times = n()) %&gt;% ungroup() %&gt;% group_by(type) %&gt;% mutate(prop = num_times/sum(num_times)) %&gt;% .[order(.$prop, decreasing = TRUE),] %&gt;% head()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;total&#39;, &#39;alpha&#39;. You can
override using the `.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 6
# Groups:   type [2]
  meth_pattern total alpha type    num_times   prop
  &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;int&gt;  &lt;dbl&gt;
1 C                1     1 luad          229 0.369 
2 C                1     1 healthy        99 0.285 
3 T                1     0 luad           94 0.151 
4 T                1     0 healthy        42 0.121 
5 CC               2     1 healthy        36 0.104 
6 CC               2     1 luad           57 0.0918</code></pre>
<ul>
<li>maybe question is: what are the alphas of the meth patterns that
occur most frequently?</li>
<li>and are they more centered at 0 and 1 than the least frequent meth
patterns?</li>
</ul>
<pre class="r"><code>overlap_bins_reads %&gt;% filter(bin_num == 3780) %&gt;% group_by(meth_pattern, total, alpha, type) %&gt;% summarise(num_times = n()) %&gt;% ungroup() %&gt;% group_by(type) %&gt;% mutate(prop = num_times/sum(num_times)) %&gt;% .[order(.$prop, decreasing = TRUE),] %&gt;%
  ggplot(aes(x = alpha, y = prop, colour = type)) +
  geom_point() +
  geom_line()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;total&#39;, &#39;alpha&#39;. You can
override using the `.groups` argument.</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" />
* yes - highest props are at 0 and 1 and then 0.5</p>
<ul>
<li><p>but this is likely biased to meth pattern =0/1 because only a c
or a t</p></li>
<li><p>at least 3 cpg on read</p></li>
</ul>
<pre class="r"><code>overlap_bins_reads %&gt;% filter(bin_num == 3780, total &gt;= 3) %&gt;% group_by(meth_pattern, total, alpha, type) %&gt;% summarise(num_times = n()) %&gt;% ungroup() %&gt;% group_by(type) %&gt;% mutate(prop = num_times/sum(num_times)) %&gt;% .[order(.$prop, decreasing = TRUE),] %&gt;%
  ggplot(aes(x = alpha, y = prop, colour = type)) +
  geom_point() +
  geom_line()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;total&#39;, &#39;alpha&#39;. You can
override using the `.groups` argument.</code></pre>
<p><img src="figure/alphaAnalysis.Rmd/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" />
* props change quite a bit * also this is all specific to just one bin *
is this interesting? - no clue</p>
<pre class="r"><code>all_samples[1:10,]</code></pre>
<pre><code>                                read_id seqnames    start      end read_length
1  7f095597-d2c5-47a2-93aa-d84b7f9abc94    chr22 10521100 10521455         355
2  e9abf215-8192-48f4-a50f-ef92241e5de3    chr22 10522473 10522658         185
3  4203dd9d-9bff-4d14-b046-7716315e9699    chr22 10524645 10524786         141
4  baf45276-b37b-43fd-8a33-6727de6255fa    chr22 10527072 10527210         138
5  a75ce5a8-42f2-4fe2-b62b-35aba109507d    chr22 10529269 10529453         184
6  b5e822b7-e149-4ae2-8937-fe4d570a274e    chr22 10534032 10534204         172
7  8dd08ad7-e4df-431f-aa3a-71b2997ef046    chr22 10537405 10537724         319
8  f2126575-4306-42fe-a40f-9ea13798f81d    chr22 10537537 10537896         359
9  188323d5-c832-4819-a396-256378a12c58    chr22 10540305 10540479         174
10 e7aa75c7-ca75-4127-885c-3a66df33217c    chr22 10540592 10540761         169
      type sample index_cg      meth_pattern
1  healthy hu5.10       48                 T
2  healthy hu5.10       53              CCTT
3  healthy hu5.10       68                 T
4  healthy hu5.10      299 CCCCCCCCCCCCCCCCC
5  healthy hu5.10      374                TT
6  healthy hu5.10      408                TT
7  healthy hu5.10      462                 T
8  healthy hu5.10      462                 T
9  healthy hu5.10      474                 C
10 healthy hu5.10      476                 C
                                                         cpg_positions
1                                                                   48
2                                                          53,54,55,56
3                                                                   68
4  299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315
5                                                              374,375
6                                                              408,409
7                                                                  462
8                                                                  462
9                                                                  474
10                                                                 476
                                                                                                                                            genom_positions
1                                                                                                                                                  10521180
2                                                                                                                       10522481,10522501,10522591,10522649
3                                                                                                                                                  10524771
4  10527071,10527087,10527090,10527093,10527108,10527114,10527116,10527119,10527130,10527136,10527138,10527153,10527156,10527172,10527189,10527191,10527194
5                                                                                                                                         10529326,10529356
6                                                                                                                                         10534125,10534167
7                                                                                                                                                  10537632
8                                                                                                                                                  10537632
9                                                                                                                                                  10540347
10                                                                                                                                                 10540628
   num_meth total alpha read_start read_end
1         0     1   0.0   10521100 10521455
2         2     4   0.5   10522473 10522658
3         0     1   0.0   10524645 10524786
4        17    17   1.0   10527072 10527210
5         0     2   0.0   10529269 10529453
6         0     2   0.0   10534032 10534204
7         0     1   0.0   10537405 10537724
8         0     1   0.0   10537537 10537896
9         1     1   1.0   10540305 10540479
10        1     1   1.0   10540592 10540761</code></pre>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern, type, sample) %&gt;% summarise(n=n()) %&gt;% head()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;type&#39;. You can override
using the `.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 4
# Groups:   meth_pattern, type [1]
  meth_pattern type    sample        n
  &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt;
1 C            healthy hu5.10     4357
2 C            healthy hu5.11     5027
3 C            healthy hu5.12     3509
4 C            healthy ispro.bc2  5579
5 C            healthy ispro.bc3  6499
6 C            healthy ispro.bc4  7476</code></pre>
</div>
<div
id="how-long-is-a-piece-of-string---whats-the-longest-for-the-same-alpha"
class="section level1">
<h1>how long is a piece of string? - what’s the longest for the same
alpha</h1>
<pre class="r"><code>all_samples %&gt;% distinct(meth_pattern, total, alpha) %&gt;% .[order(.$total, decreasing = TRUE),] %&gt;% mutate(num = 1:n()) %&gt;% head()</code></pre>
<pre><code>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              meth_pattern
21435 TCCCCTCCCCCCCCCCCCTCCCCCCCCCCTCCCTTCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCTTTTTTTTCCCCCCCCCCCCCCCCTTCCCCCTCCCCCCCCCCCTCCCCCCCCCCCCTCCCCCCCCCCTTCCCCTCCTCCCCCCCCTCCCCCTTTTCTTCCCTCCCCCCCCCCCCCCCCTCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCTTCTTTCCCCCCCCCTTCCCCCCCTCTCCCCTCCCCCCCCCCCCCCCCTCCCCCCCCTCCCCCCCCCTTCCCCCCTCCCCCCCCCCCCCCCCTCCCCTTCTCCCCCCCCCTCCCCTCTTTCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCTCCCCTCTTTCCTCCCCCTTCCTCCCCCTCCCCCCCCCCTCCCCTCCCCCCTTCCCCCCCTCCCCCTCCCCCTCCTTCCTCCCCCTCCTCCCTTTTTCTTTCCTTTTTTTTTTTTTTTTCCCCTCCCCTCCTTCCCCTCCTCCCTCCTTCTTCCCCTCCCTTCCCCCCCCCCCCCCCTCCCCTTTCCCCTTCCTCTTTTTCTTTTC
16830                                                                                         CCTTTTTTTTTTTTTTTTCTCTTTTTTTTCTTTTCCCCCCCTTCTTCTTCCCCCCCCCCCCTCCCCCCCTTCCCCCTTCCCCCCCCCCCCTCCCCCCCCCCCCCCTTCCCCCCCCCTCCCCCCCCCCCTCTCCCCCCCCCCCCCCCCCTCCTCCTCCCCCCTCCCCCCCCCCCCCCCCCCCTCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCTCCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCTCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTTTCCTCCCTCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCCCTCTCCCCCTCCCCCCCCCTCCCTCCCTCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
20289                                                                                                                            CTCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCTCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCTCCCCCCCTCCCCCTCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCTCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCTTCCCCCCCCCCCCCCCCTCCCCCCCCTTTTTTCCCCCCTCTCCCCCTTTCCCCCCCCCCCCCCCCCCCCCCCCCCCTTCCCTTCCCCCCCCCCCCCCCTCCCCCCCTCCCCTTTTTCCTCTTTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTTTTTTTTCCTCCCCCCCCCTTTCCCCCCCCCTCCCTCCCCCCCCCCCCCTCCCCCCCCCCCCCCTCCCCCCCCCCTCTTTTTTTCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCTCCCCCCCCCCTCCC
21352                                                                                                                                     TTTTTCCTCTTTCCTTCCCCCCCCTTCCCCCTTTTCTTCTTCCCCCCCCCTTCTCCCCCCTCCCTCCCCTTCCTCCTCCTTTCTCTCTCCCCCCCTTCTTTTCCCCCCCCTCTCCCCTTTTTTTTTTTTTTTTTTTTTTTCTTCTCCTCCCCTCCCCCCCCCTCTCTCCCCCCCCCCCCCCCCTTCCTCTCCCCCCCCCCCCCCTCTCCCCCCCTCCCTCCCCCCCTCCTTTCCCCCCCCCCCCCCTCCTCCTCTCTTCTTTCTTCTTTTTTTTTTTTCTTTTTTCTCTTTCCCCCTTCCCCCTCCCCCCCCCCCCCCCCCCCCCTCCCTTTTTCTTCCTTCCCCCTTCCTTCTTCCCCCCTCCCTTTCTTTTTTCTTCTTCTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTCCTTTTTTTCTTTTTTCTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTCTTTTTTTTC
16987                                                                                                                                                       CCCCTCTCCCCCCCCCCTCCCCCCCCCTCCCCCCCCCCCCCTTTCCCCCCCCCCCCCCCCCCTCCCCCCCTCCCTCCTCCCCCCCCCCCCCCCCCCCCTCCCTCCCCTCCCCCCCCCCCCCCCCTCCCCCCCCCTCCCCCCCCCCCCCCTCCTCCCTCCCCTCCCCCCTCTCCCCCCTTCCCCCTTTCTTTTCCCTCCCCTCCCCTCCCCCCCCCCCCCCCTCCCCCCCCCTCCCCCCCCCCCCCCCTCTCCCCCTCTCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCTCCCCCTTCCCTCCCCCCTCTCTCCCCTCCTCCTCCCCCCCTCCCCCCCCCCTCCCCCCCCCTCCCCCCCCCCCCCTCCTCCCCCCCTCCTCCCCCCCCCCCTCCCCTCCCCCTTCCCCCCCCCCCCCCCCTCCCTCCCCCCTCCCCCTCCTTTCCCCCCCCCCCCCT
20165                                                                                                                                                                                                                                       CTCCCCCCCCCCCCCCCCCCCCCTTCTCCCCCCCCCCTCCCCCCCCCCTCCCCCCCCTCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCCCCCCCTCCCCCCCCCCCCTTCCCCCCCCCCCCCCCCTCCTTTCCCTCCTCCCCCCCCCCCCCCCCCCCCCCCCCCTCCCCCCCCCCTCTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTCCTCTTCCCCCCCCCCCCCCCTCTCCCCCCCCTTCCTCCCCCCTCCCTTCCCCCCTCCCCCCCCTCTCCCCCTCCCCTTCCCCCTCCCCTCTCCCTCCTCCCCCCCTCCCCCTCCCCCCCCCCCCCCCCTCCTTCCCCTCCCCCT
      total     alpha num
21435   612 0.7761438   1
16830   524 0.8568702   2
20289   489 0.8588957   3
21352   480 0.4895833   4
16987   462 0.8484848   5
20165   382 0.8664921   6</code></pre>
<pre class="r"><code>all_samples %&gt;% distinct(meth_pattern, total, alpha) %&gt;% .[order(.$total, decreasing = TRUE),] %&gt;% mutate(num = 1:n()) %&gt;% filter(alpha == 1 | alpha == 0) %&gt;% head()</code></pre>
<pre><code>                                                            meth_pattern total
1 TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    70
2   CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC    68
3          TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    61
4            TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    59
5             TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    58
6              TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT    57
  alpha  num
1     0  711
2     1  764
3     0  969
4     0 1062
5     0 1094
6     0 1138</code></pre>
<ul>
<li>longest is 70 unmethylated cpgs</li>
<li>then 68 methylated cpgs</li>
<li>7/10 in top 10 are unmethylated strings - interesting</li>
</ul>
<pre class="r"><code>all_samples %&gt;% group_by(meth_pattern, total, alpha) %&gt;% summarise(n_times = n()) %&gt;% ungroup() %&gt;% .[order(.$total, decreasing = TRUE),] %&gt;% mutate(num = 1:n()) %&gt;% filter(alpha == 1 | alpha == 0) %&gt;% head()</code></pre>
<pre><code>`summarise()` has grouped output by &#39;meth_pattern&#39;, &#39;total&#39;. You can override
using the `.groups` argument.</code></pre>
<pre><code># A tibble: 6 × 5
  meth_pattern                                         total alpha n_times   num
  &lt;chr&gt;                                                &lt;int&gt; &lt;dbl&gt;   &lt;int&gt; &lt;int&gt;
1 TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT…    70     0       2   728
2 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC…    68     1       1   748
3 TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT…    61     0       2   991
4 TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT…    59     0       1  1065
5 TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT…    58     0       1  1111
6 TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT…    57     0       2  1156</code></pre>
<ul>
<li>unsurprisingly - they are rare</li>
</ul>
</div>
<div
id="are-there-any-meth-patterns-that-happen-in-only-cancer-or-only-normal"
class="section level1">
<h1>are there any meth patterns that happen in only cancer or only
normal?</h1>
<pre class="r"><code>all_samples %&gt;% group_by(type) %&gt;% distinct(meth_pattern) %&gt;% ungroup() %&gt;% group_by(meth_pattern) %&gt;% mutate(n_groups = n()) %&gt;% ungroup() %&gt;% filter(n_groups == 1) %&gt;% group_by(type) %&gt;% summarise(n_unique = n())</code></pre>
<pre><code># A tibble: 2 × 2
  type    n_unique
  &lt;chr&gt;      &lt;int&gt;
1 healthy     8518
2 luad       10866</code></pre>
</div>
<div id="section" class="section level1">
<h1></h1>
<ul>
<li>can’t remember what alicia was talking about</li>
<li>it was something to do with an average</li>
<li>but alpha is already basically an average as well as prop (if you
say meth is 1 and unmeth is 0 - you count the meth and divide by
total)</li>
<li>oh it was a per position thing - like each site has a value that is
the average of the alphas that span the site</li>
<li>we wanted to then compare it to beta - except something is wrong
with beta</li>
</ul>
<pre class="r"><code>cg_sites[1:10,]</code></pre>
<pre><code>              pos seqnames    start      end width seq index
1  chr22-10510235    chr22 10510235 10510236     2  CG     1
2  chr22-10510275    chr22 10510275 10510276     2  CG     2
3  chr22-10510284    chr22 10510284 10510285     2  CG     3
4  chr22-10510338    chr22 10510338 10510339     2  CG     4
5  chr22-10510437    chr22 10510437 10510438     2  CG     5
6  chr22-10510532    chr22 10510532 10510533     2  CG     6
7  chr22-10511578    chr22 10511578 10511579     2  CG     7
8  chr22-10511696    chr22 10511696 10511697     2  CG     8
9  chr22-10511893    chr22 10511893 10511894     2  CG     9
10 chr22-10512048    chr22 10512048 10512049     2  CG    10</code></pre>
<pre class="r"><code>av_alpha &lt;- all_samples %&gt;% separate_rows(genom_positions, sep = &quot;,&quot;)</code></pre>
<pre class="r"><code>av_alpha %&gt;% group_by(genom_positions) %&gt;% summarise(av_alpha = mean(alpha), median_alpha = median(alpha), sd_alpha = sd(alpha)) %&gt;% head()</code></pre>
<pre><code># A tibble: 6 × 4
  genom_positions av_alpha median_alpha sd_alpha
  &lt;chr&gt;              &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 10510235           0.307        0.25     0.282
2 10510275           0.346        0.292    0.275
3 10510284           0.346        0.292    0.275
4 10510338           0.275        0.25     0.247
5 10510437           0.3          0.3      0.424
6 10510532           0.5          0.5      0.707</code></pre>
<ul>
<li>I need the betas to compare against</li>
</ul>
<pre class="r"><code>all_samples[1:10,]</code></pre>
<pre><code>                                read_id seqnames    start      end read_length
1  7f095597-d2c5-47a2-93aa-d84b7f9abc94    chr22 10521100 10521455         355
2  e9abf215-8192-48f4-a50f-ef92241e5de3    chr22 10522473 10522658         185
3  4203dd9d-9bff-4d14-b046-7716315e9699    chr22 10524645 10524786         141
4  baf45276-b37b-43fd-8a33-6727de6255fa    chr22 10527072 10527210         138
5  a75ce5a8-42f2-4fe2-b62b-35aba109507d    chr22 10529269 10529453         184
6  b5e822b7-e149-4ae2-8937-fe4d570a274e    chr22 10534032 10534204         172
7  8dd08ad7-e4df-431f-aa3a-71b2997ef046    chr22 10537405 10537724         319
8  f2126575-4306-42fe-a40f-9ea13798f81d    chr22 10537537 10537896         359
9  188323d5-c832-4819-a396-256378a12c58    chr22 10540305 10540479         174
10 e7aa75c7-ca75-4127-885c-3a66df33217c    chr22 10540592 10540761         169
      type sample index_cg      meth_pattern
1  healthy hu5.10       48                 T
2  healthy hu5.10       53              CCTT
3  healthy hu5.10       68                 T
4  healthy hu5.10      299 CCCCCCCCCCCCCCCCC
5  healthy hu5.10      374                TT
6  healthy hu5.10      408                TT
7  healthy hu5.10      462                 T
8  healthy hu5.10      462                 T
9  healthy hu5.10      474                 C
10 healthy hu5.10      476                 C
                                                         cpg_positions
1                                                                   48
2                                                          53,54,55,56
3                                                                   68
4  299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315
5                                                              374,375
6                                                              408,409
7                                                                  462
8                                                                  462
9                                                                  474
10                                                                 476
                                                                                                                                            genom_positions
1                                                                                                                                                  10521180
2                                                                                                                       10522481,10522501,10522591,10522649
3                                                                                                                                                  10524771
4  10527071,10527087,10527090,10527093,10527108,10527114,10527116,10527119,10527130,10527136,10527138,10527153,10527156,10527172,10527189,10527191,10527194
5                                                                                                                                         10529326,10529356
6                                                                                                                                         10534125,10534167
7                                                                                                                                                  10537632
8                                                                                                                                                  10537632
9                                                                                                                                                  10540347
10                                                                                                                                                 10540628
   num_meth total alpha read_start read_end
1         0     1   0.0   10521100 10521455
2         2     4   0.5   10522473 10522658
3         0     1   0.0   10524645 10524786
4        17    17   1.0   10527072 10527210
5         0     2   0.0   10529269 10529453
6         0     2   0.0   10534032 10534204
7         0     1   0.0   10537405 10537724
8         0     1   0.0   10537537 10537896
9         1     1   1.0   10540305 10540479
10        1     1   1.0   10540592 10540761</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.4.1 (2024-06-14)
Platform: x86_64-pc-linux-gnu
Running under: Red Hat Enterprise Linux 9.5 (Plow)

Matrix products: default
BLAS/LAPACK: FlexiBLAS OPENBLAS-OPENMP;  LAPACK version 3.9.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

time zone: Australia/Melbourne
tzcode source: system (glibc)

attached base packages:
[1] stats4    stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] ggplot2_3.5.2        dplyr_1.1.4          tidyr_1.3.1         
 [4] plyranges_1.26.0     GenomicRanges_1.58.0 GenomeInfoDb_1.42.3 
 [7] IRanges_2.40.1       S4Vectors_0.44.0     BiocGenerics_0.52.0 
[10] workflowr_1.7.1     

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1            farver_2.1.2               
 [3] Biostrings_2.74.1           bitops_1.0-9               
 [5] fastmap_1.2.0               RCurl_1.98-1.17            
 [7] GenomicAlignments_1.42.0    promises_1.3.3             
 [9] XML_3.99-0.18               digest_0.6.37              
[11] lifecycle_1.0.4             processx_3.8.6             
[13] magrittr_2.0.3              compiler_4.4.1             
[15] rlang_1.1.6                 sass_0.4.10                
[17] tools_4.4.1                 utf8_1.2.6                 
[19] yaml_2.3.10                 rtracklayer_1.66.0         
[21] knitr_1.50                  S4Arrays_1.6.0             
[23] labeling_0.4.3              curl_6.4.0                 
[25] DelayedArray_0.32.0         RColorBrewer_1.1-3         
[27] abind_1.4-8                 BiocParallel_1.40.2        
[29] withr_3.0.2                 purrr_1.1.0                
[31] grid_4.4.1                  git2r_0.36.2               
[33] scales_1.4.0                SummarizedExperiment_1.36.0
[35] cli_3.6.5                   rmarkdown_2.29             
[37] crayon_1.5.3                generics_0.1.4             
[39] rstudioapi_0.17.1           httr_1.4.7                 
[41] rjson_0.2.23                cachem_1.1.0               
[43] stringr_1.5.1               zlibbioc_1.52.0            
[45] parallel_4.4.1              BiocManager_1.30.26        
[47] XVector_0.46.0              restfulr_0.0.16            
[49] matrixStats_1.5.0           vctrs_0.6.5                
[51] Matrix_1.7-0                jsonlite_2.0.0             
[53] callr_3.7.6                 jquerylib_0.1.4            
[55] glue_1.8.0                  codetools_0.2-20           
[57] ps_1.9.1                    stringi_1.8.7              
[59] gtable_0.3.6                later_1.4.2                
[61] BiocIO_1.16.0               UCSC.utils_1.2.0           
[63] tibble_3.3.0                pillar_1.11.0              
[65] htmltools_0.5.8.1           GenomeInfoDbData_1.2.13    
[67] R6_2.6.1                    rprojroot_2.1.0            
[69] evaluate_1.0.4              lattice_0.22-6             
[71] Biobase_2.66.0              Rsamtools_2.22.0           
[73] renv_1.1.5                  httpuv_1.6.16              
[75] bslib_0.9.0                 Rcpp_1.1.0                 
[77] SparseArray_1.6.2           whisker_0.4.1              
[79] xfun_0.52                   fs_1.6.6                   
[81] MatrixGenerics_1.18.1       getPass_0.2-4              
[83] pkgconfig_2.0.3            </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
